---
title: Prisma Adapter
description: Using Prisma with database-enabled Fragments
---

import { Callout } from "fumadocs-ui/components/callout";

The Prisma adapter integrates Fragno database Fragments with your Prisma workflow.

Fragno still executes SQL via **Kysely's `Dialect` interface** (so it can reuse Kysely/community
Dialects). Prisma is the schema output here: the Fragno CLI generates a **`.prisma` models file** so
you can run Prisma migrations and generate Prisma Client types.

## Prerequisites

- Existing Prisma setup in your project
- A Fragno Fragment that requires database integration

## Installation

```npm
npm install @fragno-dev/db
```

## Adapter Configuration

Create a Prisma adapter using a Kysely `Dialect` + a Fragno `driverConfig`:

```typescript title="lib/database-adapter.ts"
import { PrismaAdapter } from "@fragno-dev/db/adapters/prisma";
import { PostgresDialect } from "@fragno-dev/db/dialects";
import { NodePostgresDriverConfig } from "@fragno-dev/db/drivers";
import { Pool } from "pg";

const dialect = new PostgresDialect({
  pool: new Pool({ connectionString: process.env.DATABASE_URL }),
});

export const fragmentDbAdapter = new PrismaAdapter({
  dialect,
  driverConfig: new NodePostgresDriverConfig(),
});
```

### Supported Providers

Pick a matching `driverConfig` from `@fragno-dev/db/drivers`:

- **PostgreSQL**: `NodePostgresDriverConfig` or `PGLiteDriverConfig`
- **MySQL/MariaDB**: `MySQL2DriverConfig`
- **SQLite**: `BetterSQLite3DriverConfig`, `SQLocalDriverConfig`, or
  `CloudflareDurableObjectsDriverConfig`

<Callout type="info" title="SQLite Storage Profile">
  The Prisma adapter defaults SQLite to a Prisma-native storage profile so `DateTime` and `BigInt`
  roundtrip cleanly. If you need the legacy Fragno SQLite storage layout, pass `sqliteProfile:
  "fragno"` in the adapter options.
</Callout>

<Callout type="warning" title="SQLite BigInt Safety (better-sqlite3)">
  When using better-sqlite3, enable safe integer mode to avoid precision loss for `BigInt` columns:
  `db.defaultSafeIntegers(true)`. Fragno throws if SQLite returns unsafe JS numbers.
</Callout>

## Schema Generation & Prisma Integration

The [Fragno CLI](/docs/reference/cli) generates a `.prisma` file containing only models. By default
it writes to `fragno.prisma` in the current directory.

```npm
npx @fragno-dev/cli db generate lib/comment-fragment-server.ts -o prisma/schema/fragno.prisma
```

This output is a **models-only Prisma schema**. We recommend Prisma's schema folder workflow:

1. Keep `datasource`/`generator` blocks in your main Prisma file (for example,
   `prisma/schema/schema.prisma`).
2. Generate Fragno models into `prisma/schema/fragno.prisma`.
3. Run Prisma migrations against the schema folder:

```bash
npx prisma migrate dev --schema prisma/schema
```

If you prefer a single `schema.prisma`, you can copy the generated models into your main schema
file.

## Next Steps

- Learn about [migration workflow](/docs/reference/cli)
- See [database fragments overview](/docs/fragno/for-users/database-fragments/overview)
- Read [Prisma documentation](https://www.prisma.io/docs) for advanced usage
